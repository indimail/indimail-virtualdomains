#!/bin/sh
# $Log: catChangeLog,v $
# Revision 1.6  2020-09-13 20:44:29+05:30  Cprogrammer
# renamed ChangeLog-indimail to ChangeLog
#
# Revision 1.5  2020-06-05 23:36:37+05:30  Cprogrammer
# changed ChangeLog filename
#
# Revision 1.4  2020-05-30 16:43:18+05:30  Cprogrammer
# skip blank lines
#
# Revision 1.3  2020-05-24 12:02:18+05:30  Cprogrammer
# fixed release number
#
# Revision 1.2  2020-05-21 14:38:34+05:30  Cprogrammer
# fixed timestamp
#
# Revision 1.1  2019-05-29 00:47:06+05:30  Cprogrammer
# Initial revision
#
# utility to append changelog to indimail.spec
#
#
# $Id: catChangeLog,v 1.6 2020-09-13 20:44:29+05:30 Cprogrammer Exp mbhangui $
#
flag=0
if [ $# -eq 1 ] ; then
	file=$1
else
	file=doc/ChangeLog
fi
cat $file|while read line
do
	echo "$line"|grep "^*" > /dev/null
	if [ $? -eq 0 -a $flag -ne 0 ] ; then
		break
	fi
	echo "$line" | grep "^[0-9]*/.*/.*" > /dev/null # skip dates
	if [ $? -eq 0 ] ; then
		continue
	fi
	if [ $flag -eq 0 ] ; then # first line
		echo "* `date +"%a %b %d %Y %H:%M:%S %z"` indimail-virtualdomains@indimail.org" @version@-@release@%{?dist}
		flag=1
		continue
	elif [ $flag -eq 1 ] ; then
		echo "$line"
		flag=2
		continue
	fi
	echo "$line" |grep "^[0-9]" > /dev/null
	if [ $? -eq 0 ] ; then
		echo "$line"
	elif [ -n "$line" ] ; then
		echo "    $line"
	fi
done

